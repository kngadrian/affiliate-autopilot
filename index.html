<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Affiliate Autopilot ‚Äî MunchEye Launch Dashboard</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:#0f172a;color:#e2e8f0;min-height:100vh}
.header{background:linear-gradient(135deg,#1e293b 0%,#0f172a 100%);border-bottom:1px solid #334155;padding:24px 32px}
.header h1{font-size:28px;font-weight:700;background:linear-gradient(90deg,#60a5fa,#a78bfa);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.header p{color:#94a3b8;margin-top:4px;font-size:14px}
.stats{display:flex;gap:16px;padding:24px 32px;flex-wrap:wrap}
.stat{background:#1e293b;border:1px solid #334155;border-radius:12px;padding:16px 24px;flex:1;min-width:160px}
.stat .num{font-size:28px;font-weight:700;color:#60a5fa}.stat .label{color:#94a3b8;font-size:12px;text-transform:uppercase;letter-spacing:1px;margin-top:4px}
.filters{padding:8px 32px 16px;display:flex;gap:8px;flex-wrap:wrap}
.filters button{background:#1e293b;border:1px solid #334155;color:#cbd5e1;padding:6px 16px;border-radius:20px;cursor:pointer;font-size:13px;transition:all .2s}
.filters button:hover,.filters button.active{background:#3b82f6;border-color:#3b82f6;color:#fff}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(360px,1fr));gap:16px;padding:16px 32px 48px}
.card{background:#1e293b;border:1px solid #334155;border-radius:12px;padding:20px;transition:transform .2s,box-shadow .2s;position:relative;cursor:pointer}
.card:hover{transform:translateY(-2px);box-shadow:0 8px 24px rgba(0,0,0,.3)}
.card.mega{border-color:#f59e0b;box-shadow:0 0 0 1px #f59e0b33}
.score{position:absolute;top:16px;right:16px;width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:16px}
.score.high{background:#22c55e22;color:#22c55e;border:2px solid #22c55e}.score.med{background:#f59e0b22;color:#f59e0b;border:2px solid #f59e0b}.score.low{background:#64748b22;color:#64748b;border:2px solid #64748b}
.card h3{font-size:17px;font-weight:600;margin-bottom:6px;padding-right:48px}
.card .vendor{color:#94a3b8;font-size:13px;margin-bottom:10px}
.tags{display:flex;gap:4px;flex-wrap:wrap;margin-bottom:10px}
.tag{background:#334155;color:#94a3b8;padding:2px 10px;border-radius:10px;font-size:11px;white-space:nowrap}
.tag.ai{background:#3b82f622;color:#60a5fa}.tag.saas{background:#8b5cf622;color:#a78bfa}.tag.mktg{background:#10b98122;color:#34d399}.tag.content{background:#f59e0b22;color:#fbbf24}.tag.auto{background:#ec489922;color:#f472b6}
.meta{display:flex;gap:16px;font-size:13px;color:#94a3b8;margin-bottom:12px;flex-wrap:wrap}
.meta span{display:flex;align-items:center;gap:4px}
.card .btn{display:inline-block;background:#3b82f6;color:#fff;padding:8px 20px;border-radius:8px;text-decoration:none;font-size:13px;font-weight:500;transition:background .2s;border:none;cursor:pointer}
.card .btn:hover{background:#2563eb}
.mega-badge{display:inline-block;background:#f59e0b;color:#0f172a;font-size:10px;font-weight:700;padding:2px 8px;border-radius:4px;text-transform:uppercase;margin-left:8px}

/* Modal Styles */
.modal{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.8);z-index:1000;align-items:center;justify-content:center;padding:20px;backdrop-filter:blur(4px)}
.modal.open{display:flex}
.modal-content{background:#1e293b;border:1px solid #334155;border-radius:16px;max-width:900px;width:100%;max-height:90vh;overflow:hidden;display:flex;flex-direction:column;box-shadow:0 25px 50px rgba(0,0,0,.5)}
.modal-header{padding:24px 32px;border-bottom:1px solid #334155;display:flex;justify-content:space-between;align-items:flex-start}
.modal-header h2{font-size:24px;font-weight:700;padding-right:48px;line-height:1.3}
.close-btn{background:none;border:none;color:#94a3b8;font-size:28px;cursor:pointer;padding:0;width:32px;height:32px;display:flex;align-items:center;justify-content:center;border-radius:8px;transition:all .2s}
.close-btn:hover{background:#334155;color:#e2e8f0}
.modal-body{overflow-y:auto;flex:1}
.detail-section{padding:24px 32px}
.detail-row{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;margin-bottom:20px}
.detail-item{background:#0f172a;padding:12px 16px;border-radius:8px;border:1px solid #334155}
.detail-item .label{font-size:11px;text-transform:uppercase;color:#94a3b8;letter-spacing:1px;margin-bottom:4px}
.detail-item .value{font-size:15px;font-weight:600;color:#e2e8f0}
.score-badge{display:inline-flex;align-items:center;justify-content:center;width:64px;height:64px;border-radius:50%;font-size:28px;font-weight:700;margin-bottom:16px}
.score-badge.high{background:#22c55e22;color:#22c55e;border:3px solid #22c55e}
.score-badge.med{background:#f59e0b22;color:#f59e0b;border:3px solid #f59e0b}
.score-badge.low{background:#64748b22;color:#64748b;border:3px solid #64748b}

/* Tabs */
.tabs{display:flex;gap:8px;padding:0 32px;border-bottom:1px solid #334155;background:#0f172a}
.tab{background:none;border:none;color:#94a3b8;padding:12px 20px;cursor:pointer;font-size:14px;font-weight:500;border-bottom:2px solid transparent;transition:all .2s}
.tab:hover{color:#cbd5e1}
.tab.active{color:#60a5fa;border-bottom-color:#60a5fa}
.tab-content{display:none;padding:24px 32px}
.tab-content.active{display:block}
.tab-content h3{font-size:18px;margin-bottom:12px;color:#e2e8f0}
.tab-content h4{font-size:16px;margin-top:20px;margin-bottom:8px;color:#cbd5e1}
.tab-content p{color:#94a3b8;line-height:1.6;margin-bottom:12px}
.tab-content ul{margin-left:20px;color:#94a3b8;line-height:1.8}
.tab-content ul li{margin-bottom:6px}

/* Bonus Cards */
.bonus-card{background:#0f172a;border:1px solid #334155;border-radius:12px;padding:20px;margin-bottom:16px}
.bonus-card h4{color:#60a5fa;font-size:16px;margin-bottom:8px}
.bonus-value{display:inline-block;background:#22c55e22;color:#22c55e;padding:4px 12px;border-radius:6px;font-size:13px;font-weight:600;margin-bottom:12px}
.bonus-card p{color:#cbd5e1;line-height:1.6;margin-bottom:8px}
.bonus-why{background:#1e293b;padding:12px;border-radius:8px;border-left:3px solid #60a5fa;margin-top:12px}
.bonus-why strong{color:#60a5fa;display:block;margin-bottom:4px;font-size:13px}

/* Email Cards */
.email-card{background:#0f172a;border:1px solid #334155;border-radius:12px;padding:20px;margin-bottom:20px}
.email-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:16px;gap:16px}
.email-header h4{color:#60a5fa;font-size:16px;margin:0}
.copy-btn{background:#3b82f6;color:#fff;border:none;padding:6px 14px;border-radius:6px;font-size:12px;font-weight:500;cursor:pointer;transition:all .2s;white-space:nowrap}
.copy-btn:hover{background:#2563eb}
.copy-btn.copied{background:#22c55e}
.email-field{margin-bottom:12px}
.email-field .field-label{font-size:11px;text-transform:uppercase;color:#64748b;letter-spacing:1px;margin-bottom:4px}
.email-field .field-value{color:#cbd5e1;background:#1e293b;padding:8px 12px;border-radius:6px;font-size:13px;line-height:1.6;white-space:pre-wrap}
.email-body{color:#cbd5e1;background:#1e293b;padding:16px;border-radius:8px;font-size:14px;line-height:1.8;white-space:pre-wrap;font-family:inherit}

/* Generate Button */
.generate-btn{background:linear-gradient(135deg,#a78bfa,#60a5fa);color:#fff;border:none;padding:14px 28px;border-radius:10px;font-size:15px;font-weight:600;cursor:pointer;transition:all .2s;display:inline-block;margin-top:16px}
.generate-btn:hover{transform:translateY(-2px);box-shadow:0 8px 20px rgba(167,139,250,.3)}

/* Loading State */
.loading{display:flex;align-items:center;justify-content:center;padding:48px;color:#94a3b8}

@media(max-width:600px){.grid{grid-template-columns:1fr}.stats{flex-direction:column}.header,.stats,.filters,.grid{padding-left:16px;padding-right:16px}.modal-content{margin:10px;max-height:95vh}.modal-header,.detail-section,.tabs,.tab-content{padding-left:20px;padding-right:20px}.detail-row{grid-template-columns:1fr}.email-header{flex-direction:column;align-items:stretch}}
</style>
</head>
<body>
<div class="header">
<h1>üöÄ Affiliate Autopilot Dashboard</h1>
<p>MunchEye launches scored & filtered for Adrian's niches ‚Äî AI Tools, SaaS, Digital Marketing, Content Creation, Automation</p>
</div>
<div class="stats">
<div class="stat"><div class="num" id="totalCount">0</div><div class="label">Launches Found</div></div>
<div class="stat"><div class="num" id="topCount">0</div><div class="label">Top Scored</div></div>
<div class="stat"><div class="num" id="avgScore">0</div><div class="label">Avg Score</div></div>
<div class="stat"><div class="num" id="megaCount">0</div><div class="label">Mega Launches</div></div>
</div>
<div class="filters">
<button class="active" data-filter="all">All</button>
<button data-filter="AI Tools">ü§ñ AI Tools</button>
<button data-filter="SaaS">üíª SaaS</button>
<button data-filter="Digital Marketing">üìà Marketing</button>
<button data-filter="Content Creation">üé¨ Content</button>
<button data-filter="Automation">‚ö° Automation</button>
</div>
<div class="grid" id="grid">
<div class="loading">Loading launches...</div>
</div>

<!-- Modal -->
<div class="modal" id="modal">
<div class="modal-content">
<div class="modal-header">
<h2 id="modalTitle"></h2>
<button class="close-btn" onclick="closeModal()">√ó</button>
</div>
<div class="tabs">
<button class="tab active" onclick="switchTab('brief')">üìã Brief</button>
<button class="tab" onclick="switchTab('bonuses')">üéÅ Bonuses</button>
<button class="tab" onclick="switchTab('emails')">üìß Emails</button>
</div>
<div class="modal-body">
<div id="tab-brief" class="tab-content active"></div>
<div id="tab-bonuses" class="tab-content"></div>
<div id="tab-emails" class="tab-content"></div>
</div>
</div>
</div>

<script>
// Global state
let DATA = [];
const CAMPAIGNS = {};

// Utility: Convert product name to slug
function slugify(name) {
  return name.toLowerCase()
    .replace(/[^\w\s-]/g, '')
    .replace(/\s+/g, '-')
    .replace(/--+/g, '-')
    .trim();
}

// Markdown Parser
function parseMarkdown(markdown) {
  // Simple markdown parser - converts basic markdown to HTML
  return markdown
    .replace(/^### (.+)$/gm, '<h4>$1</h4>')
    .replace(/^## (.+)$/gm, '<h3>$1</h3>')
    .replace(/^# (.+)$/gm, '<h2>$1</h2>')
    .replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>')
    .replace(/\*(.+?)\*/g, '<em>$1</em>')
    .replace(/^- (.+)$/gm, '<li>$1</li>')
    .replace(/(<li>.*<\/li>)/s, '<ul>$1</ul>')
    .replace(/\n\n/g, '</p><p>')
    .replace(/^(.+)$/gm, '<p>$1</p>');
}

// Parse campaign brief from markdown
function parseCampaignBrief(markdown) {
  let strategy = '';
  let targetMarket = '';
  let campaignWindow = '';
  
  // Extract metadata from markdown frontmatter or content
  const strategyMatch = markdown.match(/## Strategy Summary\s+([\s\S]+?)(?=\n#|$)/);
  if (strategyMatch) {
    strategy = strategyMatch[1].trim();
  }
  
  const targetMatch = markdown.match(/\*\*Target Market:\*\*\s+(.+)/);
  if (targetMatch) {
    targetMarket = targetMatch[1].trim();
  }
  
  const windowMatch = markdown.match(/\*\*Campaign Window:\*\*\s+(.+)/);
  if (windowMatch) {
    campaignWindow = windowMatch[1].trim();
  }
  
  return { strategy, targetMarket, campaignWindow };
}

// Parse bonuses from markdown
function parseBonuses(markdown) {
  const bonuses = [];
  // Split by bonus sections (## Bonus #1:, ## Bonus #2:, etc.)
  const sections = markdown.split(/(?=^## Bonus #\d+:)/gm).filter(s => s.trim());
  
  sections.forEach(section => {
    if (!section.includes('## Bonus #')) return;
    
    // Extract bonus name from "## Bonus #1: Name"
    const nameMatch = section.match(/## Bonus #\d+:\s+(.+?)(?=\n)/);
    const valueMatch = section.match(/\*\*Perceived Value:\*\*\s+\$(\d+)/);
    const descMatch = section.match(/\*\*Description:\*\*\s+([\s\S]+?)(?=\n\n\*\*Perceived Value)/);
    const whyMatch = section.match(/\*\*Why It Complements[^:]*:\*\*\s+([\s\S]+?)(?=\n---|\n##|$)/);
    
    if (nameMatch) {
      bonuses.push({
        name: nameMatch[1].trim(),
        value: valueMatch ? parseInt(valueMatch[1]) : 0,
        description: descMatch ? descMatch[1].trim() : '',
        why: whyMatch ? whyMatch[1].trim() : ''
      });
    }
  });
  
  return bonuses;
}

// Parse email sequence from markdown
function parseEmailSequence(markdown) {
  const emails = [];
  // Split by email sections (## DAY 1, ## DAY 2, etc.)
  const sections = markdown.split(/(?=^## DAY \d+)/gm).filter(s => s.trim());
  
  sections.forEach(section => {
    if (!section.includes('## DAY')) return;
    
    // Extract day heading "DAY 1 ‚Äî Title"
    const dayMatch = section.match(/## (DAY \d+[^\n]*)/);
    const subjectMatch = section.match(/\*\*Subject Line:\*\*\s+(.+)/);
    const previewMatch = section.match(/\*\*Preview Text:\*\*\s+(.+)/);
    const bodyMatch = section.match(/\*\*Body:\*\*\s+([\s\S]+?)(?=\n---|\n##|$)/);
    
    if (dayMatch && subjectMatch && bodyMatch) {
      emails.push({
        day: dayMatch[1].trim(),
        subject: subjectMatch[1].trim(),
        preview: previewMatch ? previewMatch[1].trim() : '',
        body: bodyMatch[1].trim()
      });
    }
  });
  
  return emails;
}

// Load campaign materials for a product
async function loadCampaign(productName) {
  const slug = slugify(productName);
  const basePath = `campaigns/${slug}`;
  
  try {
    // Try to fetch all three campaign files
    const [briefRes, bonusesRes, emailsRes] = await Promise.all([
      fetch(`${basePath}/campaign-brief.md`).catch(() => null),
      fetch(`${basePath}/bonuses.md`).catch(() => null),
      fetch(`${basePath}/email-sequence.md`).catch(() => null)
    ]);
    
    if (!briefRes || !briefRes.ok) {
      return null; // Campaign not found
    }
    
    const briefText = await briefRes.text();
    const bonusesText = bonusesRes && bonusesRes.ok ? await bonusesRes.text() : '';
    const emailsText = emailsRes && emailsRes.ok ? await emailsRes.text() : '';
    
    // Parse the markdown files
    const brief = parseCampaignBrief(briefText);
    const bonuses = bonusesText ? parseBonuses(bonusesText) : [];
    const emails = emailsText ? parseEmailSequence(emailsText) : [];
    
    return {
      brief,
      bonuses,
      emails
    };
  } catch (error) {
    console.error(`Failed to load campaign for ${productName}:`, error);
    return null;
  }
}

// Load all data
async function loadData() {
  try {
    // Load launches data
    const response = await fetch('launches_data.json');
    if (!response.ok) {
      throw new Error('Failed to load launches data');
    }
    
    DATA = await response.json();
    
    // Update stats
    updateStats();
    
    // Render initial grid
    render('all');
    
    // Load campaigns in background
    for (const product of DATA) {
      const campaign = await loadCampaign(product.product_name);
      if (campaign) {
        CAMPAIGNS[product.product_name] = campaign;
      }
    }
    
    console.log('Loaded campaigns:', Object.keys(CAMPAIGNS));
  } catch (error) {
    console.error('Failed to load data:', error);
    document.getElementById('grid').innerHTML = `
      <div style="grid-column:1/-1;text-align:center;padding:48px;color:#ef4444">
        <h3 style="margin-bottom:12px">Failed to Load Data</h3>
        <p>Could not load launches_data.json. Please check the file exists and is valid JSON.</p>
      </div>
    `;
  }
}

function updateStats() {
  document.getElementById('totalCount').textContent = DATA.length;
  document.getElementById('topCount').textContent = DATA.filter(d => d.score >= 6).length;
  document.getElementById('avgScore').textContent = DATA.length > 0 
    ? (DATA.reduce((a, d) => a + d.score, 0) / DATA.length).toFixed(1) 
    : '0';
  document.getElementById('megaCount').textContent = DATA.filter(d => d.is_mega_launch).length;
}

const tagClass = n => n.includes('AI') ? 'ai' : n.includes('SaaS') ? 'saas' : n.includes('Marketing') ? 'mktg' : n.includes('Content') ? 'content' : n.includes('Automation') ? 'auto' : '';
const scoreClass = s => s >= 7 ? 'high' : s >= 5 ? 'med' : 'low';

function render(filter) {
  const items = filter === 'all' ? DATA : DATA.filter(d => d.niche_categories.includes(filter));
  document.getElementById('grid').innerHTML = items.map(d => `
    <div class="card ${d.is_mega_launch ? 'mega' : ''}" onclick="openModal('${d.product_name.replace(/'/g, "\\'")}')">
      <div class="score ${scoreClass(d.score)}">${d.score}</div>
      <h3>${d.product_name}${d.is_mega_launch ? '<span class="mega-badge">MEGA</span>' : ''}</h3>
      <div class="vendor">${d.vendor} ¬∑ ${d.platform}</div>
      <div class="tags">${d.niche_categories.map(n => `<span class="tag ${tagClass(n)}">${n}</span>`).join('')}</div>
      <div class="meta">
        <span>üìÖ ${d.launch_date}</span>
        <span>üí∞ $${d.price_usd}</span>
        <span>üéØ ${d.commission_percent}%</span>
      </div>
      <button class="btn" onclick="event.stopPropagation(); window.open('${d.jv_page_url}', '_blank')">View JV Page ‚Üí</button>
    </div>
  `).join('');
}

function openModal(productName) {
  const product = DATA.find(d => d.product_name === productName);
  if (!product) return;
  
  const campaign = CAMPAIGNS[productName];
  
  document.getElementById('modalTitle').innerHTML = `${product.product_name}${product.is_mega_launch ? '<span class="mega-badge">MEGA</span>' : ''}`;
  
  // Brief Tab
  let briefHTML = `
    <div class="detail-section">
      <div style="display:flex;align-items:center;gap:20px;margin-bottom:24px">
        <div class="score-badge ${scoreClass(product.score)}">${product.score}</div>
        <div>
          <h3 style="margin:0 0 8px 0">${product.vendor}</h3>
          <p style="margin:0;color:#94a3b8">${product.platform} ¬∑ ${product.niche_categories.join(', ')}</p>
        </div>
      </div>
      
      <div class="detail-row">
        <div class="detail-item">
          <div class="label">Launch Date</div>
          <div class="value">üìÖ ${product.launch_date}</div>
        </div>
        <div class="detail-item">
          <div class="label">Price</div>
          <div class="value">üí∞ $${product.price_usd}</div>
        </div>
        <div class="detail-item">
          <div class="label">Commission</div>
          <div class="value">üéØ ${product.commission_percent}%</div>
        </div>
        <div class="detail-item">
          <div class="label">JV Link</div>
          <div class="value"><a href="${product.jv_page_url}" target="_blank" style="color:#60a5fa">View Page ‚Üí</a></div>
        </div>
      </div>`;
  
  if (campaign && campaign.brief && campaign.brief.strategy) {
    briefHTML += `
      <h3 style="margin-top:24px;margin-bottom:12px">Campaign Strategy</h3>
      <p style="color:#cbd5e1;line-height:1.7">${campaign.brief.strategy}</p>`;
    
    if (campaign.brief.targetMarket || campaign.brief.campaignWindow) {
      briefHTML += `
      <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px;margin-top:20px">`;
      
      if (campaign.brief.targetMarket) {
        briefHTML += `
        <div class="detail-item">
          <div class="label">Target Market</div>
          <div class="value" style="font-size:13px">${campaign.brief.targetMarket}</div>
        </div>`;
      }
      
      if (campaign.brief.campaignWindow) {
        briefHTML += `
        <div class="detail-item">
          <div class="label">Campaign Window</div>
          <div class="value" style="font-size:13px">${campaign.brief.campaignWindow}</div>
        </div>`;
      }
      
      briefHTML += `</div>`;
    }
  } else {
    briefHTML += `
      <div style="background:#0f172a;padding:24px;border-radius:12px;margin-top:24px;text-align:center">
        <p style="color:#64748b;margin-bottom:16px">Campaign materials not yet created for this launch.</p>
        <button class="generate-btn" onclick="alert('Campaign generation coming soon!')">ü§ñ Generate Campaign with AI</button>
      </div>`;
  }
  
  briefHTML += `</div>`;
  document.getElementById('tab-brief').innerHTML = briefHTML;
  
  // Bonuses Tab
  let bonusesHTML = '<div class="detail-section">';
  if (campaign && campaign.bonuses && campaign.bonuses.length > 0) {
    const totalValue = campaign.bonuses.reduce((sum, b) => sum + b.value, 0);
    bonusesHTML += `<h3 style="margin-bottom:20px">Exclusive Bonus Stack ‚Äî Total Value: $${totalValue}</h3>`;
    campaign.bonuses.forEach((bonus, idx) => {
      bonusesHTML += `
        <div class="bonus-card">
          <h4>üéÅ Bonus #${idx + 1}: ${bonus.name}</h4>
          <div class="bonus-value">Value: $${bonus.value}</div>
          <p>${bonus.description}</p>
          <div class="bonus-why">
            <strong>Why It Complements ${productName}:</strong>
            <p style="margin:0;color:#94a3b8">${bonus.why}</p>
          </div>
        </div>`;
    });
  } else {
    bonusesHTML += `
      <div style="background:#0f172a;padding:32px;border-radius:12px;text-align:center">
        <p style="color:#64748b;margin-bottom:16px">No bonuses configured yet for this launch.</p>
        <button class="generate-btn" onclick="alert('Bonus generation coming soon!')">üéÅ Generate Bonuses with AI</button>
      </div>`;
  }
  bonusesHTML += '</div>';
  document.getElementById('tab-bonuses').innerHTML = bonusesHTML;
  
  // Emails Tab
  let emailsHTML = '<div class="detail-section">';
  if (campaign && campaign.emails && campaign.emails.length > 0) {
    emailsHTML += `<h3 style="margin-bottom:20px">${campaign.emails.length}-Day Email Sequence</h3>`;
    campaign.emails.forEach((email, idx) => {
      emailsHTML += `
        <div class="email-card">
          <div class="email-header">
            <h4>${email.day}</h4>
            <button class="copy-btn" onclick="copyEmail(${idx}, '${productName.replace(/'/g, "\\'")}')">üìã Copy Email</button>
          </div>
          <div class="email-field">
            <div class="field-label">Subject Line</div>
            <div class="field-value">${email.subject}</div>
          </div>
          <div class="email-field">
            <div class="field-label">Preview Text</div>
            <div class="field-value">${email.preview}</div>
          </div>
          <div class="email-field">
            <div class="field-label">Email Body</div>
            <div class="email-body">${email.body}</div>
          </div>
        </div>`;
    });
  } else {
    emailsHTML += `
      <div style="background:#0f172a;padding:32px;border-radius:12px;text-align:center">
        <p style="color:#64748b;margin-bottom:16px">Email sequence not yet created for this launch.</p>
        <button class="generate-btn" onclick="alert('Email generation coming soon!')">‚úâÔ∏è Generate Email Sequence with AI</button>
      </div>`;
  }
  emailsHTML += '</div>';
  document.getElementById('tab-emails').innerHTML = emailsHTML;
  
  document.getElementById('modal').classList.add('open');
  document.body.style.overflow = 'hidden';
  switchTab('brief');
}

function closeModal() {
  document.getElementById('modal').classList.remove('open');
  document.body.style.overflow = '';
}

function switchTab(tabName) {
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
  event.target.classList.add('active');
  document.getElementById('tab-' + tabName).classList.add('active');
}

function copyEmail(emailIdx, productName) {
  const campaign = CAMPAIGNS[productName];
  if (!campaign || !campaign.emails[emailIdx]) return;
  
  const email = campaign.emails[emailIdx];
  const fullEmail = `Subject: ${email.subject}\n\nPreview: ${email.preview}\n\n${email.body}`;
  
  navigator.clipboard.writeText(fullEmail).then(() => {
    const btns = document.querySelectorAll('.copy-btn');
    const btn = btns[emailIdx];
    const originalText = btn.innerHTML;
    btn.innerHTML = '‚úì Copied!';
    btn.classList.add('copied');
    setTimeout(() => {
      btn.innerHTML = originalText;
      btn.classList.remove('copied');
    }, 2000);
  });
}

// Close modal on outside click
document.getElementById('modal').addEventListener('click', (e) => {
  if (e.target.id === 'modal') closeModal();
});

// Close modal on Escape
document.addEventListener('keydown', (e) => {
  if (e.key === 'Escape') closeModal();
});

// Filter buttons
document.querySelectorAll('.filters button').forEach(btn => {
  btn.addEventListener('click', () => {
    document.querySelectorAll('.filters button').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    render(btn.dataset.filter);
  });
});

// Initialize on load
loadData();
</script>
</body>
</html>
